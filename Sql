SELECT DISTINCT c.*
FROM EPC.ENERGY_CERTIFICATE c
JOIN EPC.ADDRESS a ON a.AD_EPC_ID = c.EPC_ID
JOIN EPC.BLACKBOARD b ON b.UUID = c.EPC_UUID
WHERE a.AD_ADDRESS_SOURCE = 'FD VALIDATED'
AND NOT EXISTS (
    SELECT 1
    FROM EPC.EPC_PROP_JOIN_DETAILS p
    WHERE p.EPC_ID = c.EPC_ID
      AND (p.VALIDATION_STATUS = 'FAILED' OR p.VALIDATION_STATUS IS NULL)
);
